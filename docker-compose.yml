services:
  app:
    build: .
    ports:
      - "3000:3000"
    env_file:
      - .env
    environment:
      - PORT=3000
      - AWS_REGION=us-east-1
      - AWS_ACCOUNT_ID=838693051036
      - S3_ACCESS_POINT_NAME=cs450-s3
      - PYTHONUNBUFFERED=1
    volumes:
      # Mount for development (hot reload)
      - ./src:/app/src
      - ./frontend:/app/frontend
      # Mount AWS credentials from host (optional, for local development)
      # Uncomment ONE of the lines below that matches your system:
      # 
      # For Linux/Mac (uses ${HOME} environment variable):
      # - ${HOME}/.aws:/root/.aws:ro
      #
      # For Windows (replace YourUsername with your actual username):
      # - C:/Users/YourUsername/.aws:/root/.aws:ro
      #
      # Or set AWS_CREDENTIALS_PATH in .env file and use:
      # - ${AWS_CREDENTIALS_PATH}:/root/.aws:ro
      #
      # Note: In production (AWS ECS), use IAM roles instead of mounting credentials
    restart: unless-stopped